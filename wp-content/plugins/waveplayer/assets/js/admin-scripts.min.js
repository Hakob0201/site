!function(e,t){"use strict";var a,l;document.addEventListener("waveplayer.engine.ready",o=>{const r=o.detail.engine;r.setOption("autoplay",!1);e(document).on("click","#woocommerce-product-data .preview_files a.insert",function(){return e(this).closest(".preview_files").find("tbody").append(e(this).data("row")),!1}),e(document).on("click","#woocommerce-product-data .preview_files a.delete",function(){return e(this).closest("tr").remove(),!1}),e(".preview_files tbody").sortable({items:"tr",cursor:"move",axis:"y",handle:"td.sort",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65}),e(document).on("click",".upload_preview_button",function(t){var o=e(this);if(l=o.closest("tr").find("td.file_url input"),t.preventDefault(),a)a.open();else{var r=[new wp.media.controller.Library({library:wp.media.query({type:"audio"}),multiple:!0,title:o.data("choose"),priority:20,filterable:"all"})];(a=wp.media.frames.preview_file=wp.media({title:o.data("choose"),library:{type:"audio"},button:{text:o.data("update")},multiple:!0,states:r})).on("select",function(){var e="";a.state().get("selection").map(function(t){(t=t.toJSON()).url&&(e=t.url)}),l.val(e).change()}),a.on("ready",function(){a.uploader.options.uploader.params={type:"download_preview"}}),a.open()}}),document.location.href.includes("page=waveplayer")&&(()=>{const a=r.vars.options.override_wave_colors;let l;iro.use(iroTransparencyPlugin);const o=function(t=!0){l=null,e("#color-picker").remove(),e("#color-picker-container").append(e("<div>",{id:"color-picker"})),(l=new iro.ColorPicker("#color-picker",{width:120,color:"rgb(255, 0, 0)",borderWidth:1,handleRadius:5,sliderHeight:20,sliderMargin:10,borderColor:"#000",transparency:t})).on(["color:change"],function(t){let a=document.querySelector(".color-swatch.current");if(!a)return;const l=u(t.hex8String);if(a.classList.contains("palette-swatch")){const l=e(a).index(),o=e("#palette").attr("data-colors").split("-");o[l]=t.hexString.replace("#",""),a.dataset.color=Object.values(t.rgb).join(","),a.dataset.hue=t.hsl.h,i(o)}else{const e=a.nextElementSibling;e&&(e.value=l),a.style.backgroundColor=l;const t=a.dataset.name.replace("waveplayer_","");wvplVars.options[t]=l,p()}e("#color-picker-value").val(l).select().focus()})};if(document.location.search.includes("page=waveplayer")){const t=e("#waveplayer_current_tab").val();"waveform"===t?(o(),r.vars.options.override_wave_colors=!1):"palettes"===t&&(o(!1),r.vars.options.override_wave_colors=a),window.history.replaceState({page:"waveplayer",tab:t},e(`#waveplayer-${t} h2`).text()+" ‹ WavePlayer Settings",`${document.location.pathname}?page=waveplayer&tab=${t}`),e("input[name=_wp_http_referer]").val(e("input[name=_wp_http_referer]").val().replace(/\&tab=(.*)/,`&tab=${t}`));let l=0;const n=e("#waveplayer-palettes").is(":visible");e("#waveplayer-palettes").show(),e(".wvpl-palette-selectbox ul").show(),e(".wvpl-palette-selectbox li.wvpl-palette-item").each((t,a)=>{const o=e(a).find(".wvpl-palette-item-name").get(0);o&&"SPAN"===o.tagName&&(l=Math.max(l,125+Number(getComputedStyle(o).getPropertyValue("width").replace("px",""))))}),e(".wvpl-palette-selectbox ul").hide(),e("#waveplayer-palettes").toggle(n),e(".wvpl-palette-selectbox>div.wvpl-palette-item").css({width:l})}window.onpopstate=(e=>{}),wp.codeEditor.initialize(e("#waveplayer_custom_css"),wvplCM.css),wp.codeEditor.initialize(e("#waveplayer_custom_js"),wvplCM.js),e(document).on("click","#waveplayer_register_license",a=>{e("#waveplayer_unregister_license + div.notice").remove();const l=e("<p>"),o=e("<div>",{class:"notice"}).append(l);if(e("#waveplayer_register_license").prop("disabled",!0).addClass("in-progress"),e("input[name=waveplayer_purchase_code]").prop("disabled",!0),!e("input[name=waveplayer_purchase_code]").val())return e("#waveplayer_unregister_license").after(o),o.addClass("update-message notice-error"),l.html(t("The purchase code cannot be empty","waveplayer")),e("#waveplayer_register_license").removeClass("in-progress").prop("disabled",!1),e("input[name=waveplayer_purchase_code]").prop("disabled",!1),!1;const n={code:e("input[name=waveplayer_purchase_code]").val(),optin:e("input#waveplayer_email_optin:checked").length,nonce:r.vars.admin_tools_nonce};r.ajaxCall("register_purchase_code",n).then(t=>{const a=e("<p>"),l=e("<div>",{class:"notice"}).append(a);e("#waveplayer_register_license").removeClass("in-progress").prop("disabled",!1),e("#waveplayer_unregister_license").after(l),t.success?(l.addClass("updated-message notice-success"),e("#waveplayer_register_license").hide(),e("span.waveplayer-register-description-block").hide(),e("#waveplayer_unregister_license").show(),e("span.waveplayer-unregister-description-block").show()):(e("input[name=waveplayer_purchase_code]").prop("disabled",!1),l.addClass("update-message notice-error")),a.html(t.data.message)})}),e(document).on("click","#waveplayer_unregister_license",t=>{e("#waveplayer_unregister_license").prop("disabled",!0).addClass("in-progress"),e("#waveplayer_unregister_license + div.notice").remove();const a={code:e("input[name=waveplayer_purchase_code]").val(),nonce:r.vars.admin_tools_nonce};r.ajaxCall("unregister_purchase_code",a).then(t=>{const a=e("<p>"),l=e("<div>",{class:"notice"}).append(a);e("#waveplayer_unregister_license").removeClass("in-progress").prop("disabled",!1).after(l),t.success?(l.addClass("updated-message notice-success"),e("#waveplayer_unregister_license").hide(),e("span.waveplayer-unregister-description-block").hide(),e("#waveplayer_register_license").show(),e("span.waveplayer-register-description-block").show(),e("input[name=waveplayer_purchase_code]").prop("disabled",!1)):l.addClass("update-message notice-error"),a.html(t.data.message)})});const n=[{var:"fc",s:20,l:10,a:1},{var:"fc-s",s:25,l:25,a:1},{var:"bc",s:20,l:90,a:1},{var:"bc-s",s:25,l:75,a:1},{var:"hc",s:30,l:40,a:1},{var:"hc-s",s:35,l:60,a:1},{var:"wc",s:70,l:40,a:1},{var:"wc-s",s:70,l:60,a:1},{var:"pc",s:60,l:25,a:1},{var:"pc-s",s:60,l:75,a:1},{var:"cc",s:60,l:40,a:1},{var:"cc-s",s:60,l:60,a:1}],i=function(t){e("#player_examples").css({"--poster-image":r}),r.getColorStyleFromPalette(t),e("#palette").attr("data-colors",t.join("-"));for(let a=n.length-1;a>=0;a--){const l=new iro.Color(`#${t[a]}`),o=Object.values(l.rgb).join(",");if(e("#palette").get(0).style.setProperty(`--${n[a].var}`,o),e(".palette-swatch").eq(a).attr("data-color",o).attr("data-hue",l.hsl.h),a<n.length-1){const t=e(".palette-swatch").eq(a+1).attr("data-hue");e(".palette-swatch").eq(a).toggleClass("linked",Math.abs(Number(t)-l.hsl.h)<5)}e("#player_examples .waveplayer").each((e,t)=>{t.style.setProperty(`--${n[a].var}`,o)})}};e("li.wvpl-palette-item.selected").length&&i(e("li.wvpl-palette-item.selected").attr("data-colors").split("-")),e(document).on("click","button#waveplayer_random_palette",t=>{!function(t=!0,a=!0){const l=Math.round(n.length/2);let o=3600*Math.random()/10,r=[];for(let i=0;i<l;i++){for(let t=0;t<2;t++){const l=2*i+t;let{s:s,l:c,a:p}=n[l];s=Math.max(0,Math.min(100,s+10*(1-2*Math.random()))),c=Math.max(0,Math.min(100,c+5*(1-2*Math.random()))),p*=1;const d=new iro.Color({h:o,s:s,l:c,a:p});r.push(d.hexString.slice(1)),a||(o=3600*Math.random()/10);const u=Object.values(d.rgb).join(",");e(`#palette>div:eq(${n[l].var})`).attr("data-color",u).attr("data-hue",d.hsl.h)}t||(o=3600*Math.random()/10)}e("#palette").attr("data-index",""),i(r)}(e("input#waveplayer_monochromatic_palette:checked").length>0,e("input#waveplayer_monochromatic_pairs:checked").length>0),e("#waveplayer-palettes .waveplayer").waveplayer("refresh"),e("#waveplayer_save_palette").prop("disabled",!1),e("input[name=waveplayer_palette_name]").val("")});var s;e(document).on("click","button#waveplayer_save_palette",t=>{t.preventDefault(),e(t.target);const a={index:e("#palette").attr("data-index"),name:e("input[name=waveplayer_palette_name]").val(),colors:e("#palette").attr("data-colors"),nonce:wvplVars.admin_tools_nonce};r.ajaxCall("save_palette",a).then(t=>{t.success&&(e("#palette").attr("data-index",t.data.index),((t,a,l,o)=>{const r=l.split("-").map(e=>`#${e}`),n=e("<li>",{class:"wvpl-palette-item"}).attr("data-id",t).attr("data-colors",l);n.append(e("<span>",{class:"wvpl-palette-item-name"}).text(a));for(const t of r)n.append(e("<span>",{class:"wvpl-palette-item-swatch"}).css("background-color",t));o>=e(".wvpl-palette-selectbox ul li").length?(e(".wvpl-palette-selectbox ul li").removeClass("selected"),n.addClass("selected"),e(".wvpl-palette-selectbox ul").append(n)):e(".wvpl-palette-selectbox ul li").eq(o).html(n.html()).addClass("selected"),e(".wvpl-palette-selectbox>div.wvpl-palette-item").html(n.html())})(t.data.id,e("input[name=waveplayer_palette_name]").val(),e("#palette").attr("data-colors"),t.data.index),e("#waveplayer_save_palette").prop("disabled",!0))})}),e(document).on("change","input#waveplayer_monochromatic_palette",t=>{const a=e("input#waveplayer_monochromatic_palette:checked").length>0;e("button#waveplayer_random_palette").click(),e("#palette>div.palette-swatch-shade").toggleClass("linked",a)}),e(document).on("change","input#waveplayer_monochromatic_pairs",t=>{const a=e("input#waveplayer_monochromatic_pairs:checked").length>0;e("input#waveplayer_monochromatic_palette").prop("disabled",!a),a||e("input#waveplayer_monochromatic_palette").prop("checked",!1),e("#palette>div.palette-swatch-main").toggleClass("linked",a),e("button#waveplayer_random_palette").click()}),e(document).on("change","input[name=waveplayer_player_background_image]",t=>{e("#player_examples .waveplayer").toggleClass("wvpl-exhibition-mode",e(t.target).prop("checked")),e("#player_examples .waveplayer").toggleClass("wvpl-exhibition-mode",e(t.target).prop("checked"))}),e(document).on("change","input[name=waveplayer_override_wave_colors]",t=>{r.vars.options.override_wave_colors=!!e("input[name=waveplayer_override_wave_colors]:checked").length,e("#waveplayer-palettes .waveplayer").waveplayer("refresh")}),e(document).on("click",".wvpl-palette-selectbox",t=>{if(e(t.target).closest("li.wvpl-palette-item").length)return!1;e(t.currentTarget).focus(),e(t.currentTarget).find("ul").toggle()}),e(document).on("click",t=>{if(e(t.target).closest(".wvpl-palette-selectbox").length)return!1;e(".wvpl-palette-selectbox").blur(),e(".wvpl-palette-selectbox").find("ul").hide()}),e(document).on("click",".wvpl-palette-selectbox ul li.wvpl-palette-item",t=>{const a=e(t.currentTarget).index(),l=e(t.currentTarget).attr("data-colors");e("input[name=waveplayer_default_palette]").val(l),e(".wvpl-palette-selectbox ul li.wvpl-palette-item").removeClass("selected"),e(".wvpl-palette-selectbox > div.wvpl-palette-item").html(e(t.currentTarget).html()),e(t.currentTarget).addClass("selected").closest("ul").hide(),e("#palette").attr("data-index",a),e("#waveplayer_save_palette").prop("disabled",!1),e("input[name=waveplayer_palette_name]").val(e(t.currentTarget).text().trim()),i(l.split("-"))}),e(document).on("click",".media-frame a.play-button",function(t){t.preventDefault();var a=e(this).data("id"),l=e(".media-frame audio#"+a)[0];return e(".media-frame audio[id!="+a+"]").each(function(t,a){e(a)[0].pause(),e(a)[0].currentTime=0}),l.paused?l.play():l.pause(),t.stopPropagation(),!1}),e(document).on("change","select[name=waveplayer_skin]",function(t){const a=e(this).find("option:selected").data("support").split(",");e("tr[data-option=size]").toggle(a.includes("size")),e("tr[data-option=shape]").toggle(a.includes("shape")),e("tr[data-option=info]").toggle(a.includes("playlist"))}),e(document).on("click",".woocommerce-music-type .woocommerce-option",function(e){}),e(document).on("click",".waveplayer_tab",t=>{t.preventDefault(),r.stop();const l=e(t.target).attr("href").replace("#","");"waveform_options"===l?(o(),r.vars.options.override_wave_colors=!1):"palettes"===l&&(o(!1),r.vars.options.override_wave_colors=a),r.stop(),e(".waveplayer_tab").removeClass("nav-tab-active"),e(t.target).addClass("nav-tab-active"),e(".waveplayer-option-page:visible").hide(),e(`#waveplayer-${l}`).show(),e(".CodeMirror").each(function(e,t){t.CodeMirror.refresh()}),e("#waveplayer_current_tab").val(l),window.history.replaceState({page:"waveplayer",tab:l},e(`#waveplayer-${l} h2`).text()+" ‹ WavePlayer Settings",`${document.location.pathname}?page=waveplayer&tab=${l}`),e("input[name=_wp_http_referer]").val(e("input[name=_wp_http_referer]").val().replace(/\&tab=(.*)/,`&tab=${l}`))}),e(document).on("click","#wvpl-sample-waveform .play-button",function(t){e(this).parent().toggleClass("playing"),r.toggle()}),e(document).on("paused","#wvpl-sample-waveform",function(t){e(this).removeClass("playing")}),e(document).on("playing","#wvpl-sample-waveform",function(t){e(this).addClass("playing")}),e(document).on("click","#waveplayer_default_thumbnail",function(t){t.preventDefault(),s?s.open():((s=wp.media({title:"Select or Upload the default thumbnail",button:{text:"Use this image"},library:{type:"image"},multiple:!1})).on("select",function(){var t=s.state().get("selection").first().toJSON();e("#waveplayer_default_thumbnail").css({backgroundImage:"url("+t.url+")"}),e("input[name=waveplayer_default_thumbnail]").val(t.url)}),s.open())}),e(document).on("click",".waveplayer-thumbnail-remove",t=>{t.preventDefault(),t.stopPropagation(),e("#waveplayer_default_thumbnail").css({backgroundImage:""}),e("input[name=waveplayer_default_thumbnail]").val("")}),e(document).on("change","select[name=waveplayer_wave_mode]",function(){e("#waveplayer_gap_width_group").toggleClass("wvpl-inactive",0==e(this).val())}),e(document).on("change","select[name=waveplayer_wave_animation]",function(){e("#waveplayer_amp_freq_ratio_group").toggleClass("wvpl-inactive",1==e(this).val()),p()}),e(document).on("change","select[name=waveplayer_amp_freq_ratio]",function(){p()});e(document).on("click",".wvpl_clear_cache",function(t){t.preventDefault();var a=e(this);const l={mode:e(this).attr("data-elements"),nonce:r.vars.admin_tools_nonce};r.ajaxCall("clear_cache",l).then(t=>{var l=t.success?"notice updated is-dismissible":"notice error is-dismissible";a.parent().append(e("<div>",{class:l}).html(e("<p>").html(t.data.message)))})}),e(document).on("click",".wvpl_delete_peaks",function(t){t.preventDefault();var a=e(this);const l={mode:e(this).attr("data-elements"),nonce:r.vars.admin_tools_nonce};r.ajaxCall("delete_peaks",l).then(t=>{var l=t.success?"notice updated is-dismissible":"notice error is-dismissible";a.parent().append(e("<div>",{class:l}).html(e("<p>").html(t.data.message)))})});var c=[];e(document).on("click",".wvpl_regenerate_peaks",function(a){a.preventDefault(),e("input.wvpl_regenerate_peaks").prop("disabled",!0),e("input[name=waveplayer_overwrite_peak_files]").prop("disabled",!0);const l={all:!0,overwrite:e("input[name=waveplayer_overwrite_peak_files]").prop("checked"),nonce:r.vars.admin_tools_nonce};r.ajaxCall("get_audio_attachments",l).then(a=>{if(a.success){var l=(c=Object.values(a.data.audioFiles)).reduce((e,t)=>Number(t.meta.length?t.meta.length:0)+e,0);e(".wvpl_regenerate_file_progress").val(0).show(),e(".wvpl_regenerate_peak_progress").val(1).prop("max",c.length).show(),e("#wvpl_regenerate_peak_notice").empty().append(e("<div>",{class:"notice updated is-dismissible"}).html(e("<p>").append(e("<span>").html(t("<strong>%s</strong> ready for peak generation","waveplayer").replace("%s",c.length))))),function t(a,l,o){if(a<c.length&&c.length>0){e(".wvpl_regenerate_peak_progress").val(a);var n=e("input[name=waveplayer_overwrite_peak_files]").prop("checked");const i=c[a];if(!i.hasPeakFile||n){const s=Date.now(),p=i.file_url,d=i.post_title,u=i.meta.length;r.getAudioData(p,i.ID,(t,a)=>{a>0&&e(".wvpl_regenerate_file_progress").val(t/a)}).then(p=>{r.decodeAudioData(p,p=>{const v=r.extractPeaks(p),m={nonce:r.vars.admin_tools_nonce,overwrite:n,peaks:v.join(",").replace(/0\./gi,"."),id:i.ID};r.ajaxCall("write_peaks",m).then(n=>{if(n.success){u&&(o-=u);const r=Date.now(),n=(r-s)/1e3,i=u/n,p=o/i,v=new Date(Date.now()+Math.round(1e3*p));e("#wvpl_regenerate_peak_notice").empty().append(e("<div>",{class:"notice updated is-dismissible"}).html(e("<p>").append(e("<span>").html(`${a+1} done, ${c.length-a-1} files to go`),e("<br>"),e("<span>").html(`Peak file for “<strong>${d}</strong>” was successfully regenerated in ${Math.round(100*n)/100} seconds (<strong>${Math.round(100*i/60)/100} min/s</strong>)`),e("<br>"),e("<span>").html(`Estimated completion in <strong>${Math.round(p)}</strong> seconds (${v.toLocaleTimeString()})`)))),t(++a,l+(r-s)/1e3,o)}else r.log(n.data.message)})})})}else t(++a,l)}else e("#wvpl_regenerate_peak_notice").empty().append(e("<div>",{class:"notice updated is-dismissible"}).html(e("<p>").append(c.length>0?e("<span>").html("<strong>"+c.length+" peak files</strong> were successfully regenerated in <strong>"+(Math.round(100*l)/100).toString(10)+"</strong> seconds"):e("<span>").html("No tracks needed to be regenerated.")))),e(".wvpl_regenerate_file_progress").hide(),e(".wvpl_regenerate_peak_progress").hide(),e("input.wvpl_regenerate_peaks").prop("disabled",!1),e("input[name=waveplayer_overwrite_peak_files]").prop("disabled",!1),e("input[name=waveplayer_overwrite_peak_files]").prop("checked",!1)}(0,0,l)}})});var p=function(t){e("#waveplayer-waveform .waveplayer").waveplayer("refresh")};e(document).on("click","#waveplayer_form",function(t){e(t.target).is([".color-swatch","#color-picker-value","#color-picker-container","#color-picker",".iro__wheel",".iro__wheel__lightness",".iro__slider",".iro__slider__value"].join(","))||e("#color-picker-container").removeClass("active")}),e(document).on("click","#waveplayer_form .color-swatch",function(){const t=e("#color-picker-container").width(),a=e(this).position().left-t/2,o=e(this).position().top+e(this).height()+10;let r,n;if(a+t/2>document.body.clientWidth&&(a=document.body.clientWidth-t),e("#color-picker-container").css({left:a,top:o}).addClass("active"),e(".color-swatch").removeClass("current"),e(this).addClass("current"),e(this).hasClass("palette-swatch")){const t=e(this).index(),a=e("#palette").attr("data-colors").split("-");r=new iro.Color(`#${a[t]}`),n=u(r.hexString)}else r=new iro.Color(e(this).css("background-color")),n=u(r.hex8String);e("#color-picker-value").val(n).select().focus(),l.color.hex8String=r.hex8String}),e(document).on("input","#color-picker-value",t=>{if(!d(e(t.target).val()))return!1;const a=u(e(t.target).val());if(e(".color-swatch.current").data("name")){const t=e(".color-swatch.current").data("name").replace("waveplayer_","");e(`#waveplayer_${t}`).val(a),wvplVars.options[t]=a,e(".color-swatch.current").css("background-color",a),l.color.hexString=a.hexString,p()}else{const t=e(".color-swatch.current").index(),o=e("#palette").attr("data-colors").split("-"),r=new iro.Color(a);o[t]=r.hexString.replace("#",""),e(".color-swatch.current").data("color",Object.values(r.rgb).join(",")).data("hue",r.hsl.h),l.color.hexString=r.hexString,i(o)}}),e(document).on("input",'#waveplayer-waveform :input[name^="waveplayer"]',function(){const e=this.name.replace("waveplayer_","");wvplVars.options[e]=this.value,p()}),e(document).on("change blur","input.waveplayer-color-input",function(t){let a=e(`.color-swatch[data-name=${e("#color-picker-container").data("name")}]`),l=e("#color-picker").val();if(d(l))a.css("background-color",l),p();else{let t=new iro.Color(a.css("background-color"));e("#color-picker").val(u(t.hex8String))}});const d=e=>!!e.match(/^#[\da-f]{8}$|^#[\da-f]{6}$|^#[\da-f]{4}$|^#[\da-f]{3}$/i),u=e=>{let t;return(t=e.match(/^#([\da-f]{3})f$/i))&&(e=`#${t[1]}`),(t=e.match(/^#([\da-f]{6})ff$/i))&&(e=`#${t[1]}`),(t=e.match(/^#([\da-f])\1([\da-f])\2([\da-f])\3$/i))&&(e=`#${t[1]}${t[2]}${t[3]}`),(t=e.match(/^#([\da-f])\1([\da-f])\2([\da-f])\3([\da-f])\4$/i))&&(e=`#${t[1]}${t[2]}${t[3]}${t[4]}`),e};e(document).on("click",".wvpl_toggle_selection",function(t){t.preventDefault();var a="select"==e(this).data("mode"),l=e(this).data("type");e("#waveplayer_music_"+l+" input:enabled").each(function(t,l){e(l).prop("checked",a)})}),e(document).on("keyup keypress","#waveplayer-woocommerce #track-search-input",function(e){if(13===e.keyCode)return e.preventDefault(),v(1,e.target.value),!1}),e(document).on("keyup keypress","#track-pagination #current-page-selector",function(e){if(13===e.keyCode)return e.preventDefault(),v(e.target.value),!1}),e(document).on("click","#track-pagination .pagination-links a",function(e){e.preventDefault();let t=1;const a=e.currentTarget.href.match(/paged=(\d+)/);a&&a[1]&&(t=a[1]),v(t)});const v=(t=1,a="")=>{const l={paged:t,search:a,nonce:r.vars.admin_tools_nonce};r.ajaxCall("music_inputs",l).then(t=>{if(t.success){const a=t.data.track_inputs,l=t.data.paginate_links;e("#waveplayer-woocommerce #track-pagination").html(l),e("#waveplayer-woocommerce #waveplayer_music_tracks").html(a)}else r.log(t.data.message)})};e(document).on("click",".wvpl_create_products",function(t){t.preventDefault();var a=e(this).data("type"),l=0,o=e("#waveplayer_music_"+a+" input:checked").length,n=e(".wvpl_products_progress_"+a);n.val(l).prop("max",o).show(),e("#waveplayer_music_"+a+" input:checked").each(function(t,i){const s={type:a,product_type:e("#waveplayer_woocommerce_product_type").val(),id:e(i).val(),price:e("#waveplayer_woocommerce_price_"+a).val(),tracks:e(i).data("tracks"),title:e(i).data("title"),nonce:wvplVars.admin_tools_nonce};r.ajaxCall("create_product",s).then(t=>{l++,n.val(l),e(i).prop("checked",!1).prop("disabled",!0).next().toggleClass("disabled",!0),l==o&&n.parent().append(e("<div>",{class:"notice updated is-dismissible"}).html(e("<p>").html(o+" products successfully created")))})})}),e(document).on("click","table.waveplayer-custom-fields .row-actions button.editinline",t=>{t.preventDefault();const a=e(t.target).closest("tr"),l=a.find("input.field-name").val(),o=a.find("input.field-label").val(),r=a.find("input.field-type").val(),n=a.find("input.field-default").val(),i=a.find("input.field-options").val();a.addClass("updating"),e("#custom_field_editor").find("#field_name").val(l),e("#custom_field_editor").find("#field_label").val(o),e("#custom_field_editor").find("#field_type").val(r),e("#custom_field_editor").find("#field_default").val(n),e("#custom_field_editor").find("#field_options").prop("disabled",!["select","radio"].includes(r)).val(i),e("#custom_field_editor").insertAfter(a),e(t.target).closest("table").find("tr#custom_field_editor").removeClass("hidden").data("cf-name",l)}),e(document).on("click","table.waveplayer-custom-fields .row-actions .trash a",t=>{t.preventDefault();const a=e(t.target).closest("tr"),l=a.find(".field-name").val();a&&a.remove();const o=e("#custom_field_names").val().split(",").filter(e=>e&&e!==l).join(",");e("#custom_field_names").val(o)}),e(document).on("click","table.waveplayer-custom-fields button#add-custom-field",t=>{t.preventDefault(),m(),e("#custom_field_editor").removeClass("hidden").data("cf-name",0).insertAfter(e("table.waveplayer-custom-fields tr.custom-field-row").last())}),e(document).on("keypress","table.waveplayer-custom-fields :input",t=>{13===t.which&&(t.preventDefault(),e(t.target).closest("tr").find("button#update-custom-field").click())}),e(document).on("change","table.waveplayer-custom-fields :input",t=>{t.preventDefault(),e(t.target).closest("td").find("label").removeClass("form-invalid"),e(t.target).closest("td").find(".notice").remove(),"field_label"!==t.target.id||e("table.waveplayer-custom-fields input#field_name").val()||e("table.waveplayer-custom-fields input#field_name").val(e(t.target).val().toLowerCase().replace(/[ -]/g,"_").replace(/[^a-z0-9_]/g,""))}),e(document).on("click","table.waveplayer-custom-fields button#cancel-custom-field",e=>{m()}),e(document).on("click","table.waveplayer-custom-fields button#update-custom-field",a=>{a.preventDefault();const l=e("#custom_field_editor"),o=e("table.waveplayer-custom-fields tr.updating"),r=e("#custom_field_names").val()?e("#custom_field_names").val().split(","):[],n=e("input#field_name").val(),i=e("select#field_type").val(),s=e("input#field_default").val();if(l.find(".notice").remove(),!e("input#field_name").val())return e("input#field_name").closest("label").addClass("form-invalid"),void e(a.target).closest("label").after(e("<div>",{class:"notice notice-error"}).append(e("<p>").text(t("The field name must be a valid identifier.","waveplayer"))));if(o&&n!==o.data("name")&&r.includes(n))return e("input#field_name").closest("label").addClass("form-invalid"),void e(a.target).closest("label").after(e("<div>",{class:"notice notice-error"}).append(e("<p>").text(t("Field names must be unique. A field with this name is already present.","waveplayer"))));let c,p=l.data("row");const d=["select","radio"].includes(i)?e("input#field_options").val():"";if(["select","radio"].includes(i)&&d.split(",").reduce((e,t)=>e+Number(t.length>0),0)<=1)return e("input#field_options").closest("label").addClass("form-invalid"),void e(a.target).closest("label").after(e("<div>",{class:"notice notice-error"}).append(e("<p>").text(t("The selected type of field must have at least two options. Please type two or more options, separated by commas.","waveplayer"))));let u=`name: <strong>${n}</strong><br/>\n                                   type: <strong>${i}</strong><br/>\n                                   default: <strong>${s}</strong><br/>`;d?(u=u.concat(`<br/>options: ${d}`),c=l.data("options").replace(/%%name%%/gi,n).replace(/%%options%%/gi,d)):c="",p=p.replace(/%%description%%/gi,u).replace(/%%name%%/gi,e("input#field_name").val()).replace(/%%label%%/gi,e("input#field_label").val()).replace(/%%type%%/gi,e("select#field_type").val()).replace(/%%default%%/gi,e("input#field_default").val()).replace(/%%option_input%%/gi,c),r.push(n),o.length?e(p).insertBefore(o):e(p).insertBefore(l),o.remove(),e("#custom_field_names").val(r.join(",")),m()});const m=function(){e("#custom_field_editor").addClass("hidden"),e("table.waveplayer-custom-fields tr.updating").removeClass("updating"),e("input#field_name").val(""),e("input#field_label").val(""),e("input#field_ldefault").val(""),e("select#field_type").val("text"),e("input#field_options").val("").prop("disabled",!0)};e(document).on("change","table.waveplayer-custom-fields select#field_type",t=>{t.preventDefault(),e("table.waveplayer-custom-fields input#field_options").prop("disabled",!["select","radio"].includes(e(t.target).val()))}),e(document).on("click",".notice-waveplayer-registration",e=>{r.ajaxCall("dismiss_registration_notice")}),r.audio.loop=!0})()})}(jQuery,wp.i18n.__);